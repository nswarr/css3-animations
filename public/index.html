<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="jquery.js" type="text/javascript"></script>
    <style>
        .container {
            display: flex;
            flex-flow: row nowrap;
            justify-content: center;
            align-items: stretch;

            width: 1100px;
            margin: 30px auto;
        }

        .container > section {
            flex-grow: 1;
            margin: 10px;
            border: 2px solid black;
            padding: 10px;
        }

        #reset-image-hint {
            margin: 0px auto;
            width: 15em;
            padding: 9px;
            text-align: center;
            border: 2px solid #ebebeb;
            background-color: gray;
            border-radius: 10px;
            z-index: 1000;
        }

        #viewport {
            -webkit-perspective: 400;
            -webkit-perspective-origin-x: 50%;
            -webkit-perspective-origin-y: 50%;
        }

        .pulse-small {
            transition: -webkit-transform 0.5s, opacity 0.8s;
            -webkit-transform: scale(0.9);
            opacity: 0.6;
        }

        .pulse-large {
            -webkit-transform: scale(1);
            opacity: 1;
        }

        img {
            margin: 0px 50px;
            z-index: 1;
            transition: -webkit-transform 0.5s, -webkit-perspective 0.5s;
            /*-webkit-transform-origin: 50% 50%;*/
        }

        input {
            width:3em;
        }
        label {
            display: block;
        }

    </style>
</head>
<body>

<div id="reset-image-hint">Press escape to reset image</div>
<section class="container">

    <section>
        <button id="reset" type="button">Reset</button>
        <section id="transforms">

            <label for="rotate">Rotate</label>
            <input id="rotate" type="number" data-property="rotate" data-unit="deg" />

            <label for="rotate-x">Rotate X</label>
            <input id="rotate-x" type="number" data-property="rotateX" data-unit="deg" />

            <label for="rotate-y">Rotate Y</label>
            <input id="rotate-y" type="number" data-property="rotateY" data-unit="deg" />

            <label>Scale X</label>
            <input id="scale-x" type="number" step="0.1" data-property="scaleX" />

            <label for="scale-y">Scale Y</label>
            <input id="scale-y" type="number" step="0.1" data-property="scaleY"  />

            <label for="skew-x">Skew X</label>
            <input id="skew-x" type="number" data-property="skewX" data-unit="deg" />

            <label for="skew-y">Skew Y</label>
            <input id="skew-y" type="number" data-property="skewY" data-unit="deg" />

            <label for="translate-x">Translate X</label>
            <input id="translate-x" type="number" step="5" data-property="translateX" data-unit="px" />

            <label for="translate-y">Translate Y</label>
            <input id="translate-y" type="number" step="5" data-property="translateY" data-unit="px" />

            <label for="perspective">Perspective</label>
            <input id="perspective" type="number" step="10" />
        </section>

    </section>

    <section id="viewport">
        <img id="transform-target" src="deal-with-it-cat.jpeg" />
    </section>

</section>


<script>
    function doTransform() {
        var transform = '';
        inputs.each(function(index, input) {
            input = $(input);
            var prop = input.attr('data-property');
            var unit = input.attr('data-unit') || '';
            var val = input.val();
            if (prop && val){
                transform += prop + "(" + val + unit + ") "
            }
        });

        $('#viewport').attr("style", "-webkit-perspective: " + $('#perspective').val() + "; ");

        target.attr('style', "-webkit-transform:" + transform);
    }

    function reset() {
        inputs.each(function(index, input) {
            input = $(input);
            input.val('');
        });

        doTransform();
    }

    function pulse(id) {
        elm = $(id);
        elm.addClass('pulse-small');

        elm.on("transitionend", function(e){
            elm.toggleClass('pulse-large');
        });

        setTimeout(function(){elm.addClass('pulse-large'), 1})
    }

    var target = $('#transform-target');
    var inputs = $('#transforms input');

    inputs.change(doTransform);
    $('#reset').click(reset);
    $('body').keydown(function(e){
        if (e.keyCode == 27) { reset(); }
    });

    reset();
    pulse("#reset-image-hint");

</script>

</body>
</html>